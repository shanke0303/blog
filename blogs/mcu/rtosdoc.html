<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ESP32 FreeRTOS | SHANKE BLOG</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/myblog/favicon.ico">
    <meta name="description" content="blog of shanke">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.73663e0e.css" as="style"><link rel="preload" href="/myblog/assets/js/app.d79486e6.js" as="script"><link rel="preload" href="/myblog/assets/js/3.525b3326.js" as="script"><link rel="preload" href="/myblog/assets/js/1.3355827a.js" as="script"><link rel="preload" href="/myblog/assets/js/13.e2877f91.js" as="script"><link rel="prefetch" href="/myblog/assets/js/10.069f8b69.js"><link rel="prefetch" href="/myblog/assets/js/11.f7d075bb.js"><link rel="prefetch" href="/myblog/assets/js/12.9780dcef.js"><link rel="prefetch" href="/myblog/assets/js/14.eba57fc9.js"><link rel="prefetch" href="/myblog/assets/js/15.bc4c738c.js"><link rel="prefetch" href="/myblog/assets/js/16.3a272553.js"><link rel="prefetch" href="/myblog/assets/js/17.d8aab866.js"><link rel="prefetch" href="/myblog/assets/js/18.8a59f76f.js"><link rel="prefetch" href="/myblog/assets/js/19.1b75cbd5.js"><link rel="prefetch" href="/myblog/assets/js/20.87278942.js"><link rel="prefetch" href="/myblog/assets/js/21.e3c2d4d7.js"><link rel="prefetch" href="/myblog/assets/js/22.5fae5cda.js"><link rel="prefetch" href="/myblog/assets/js/23.ec9eaba7.js"><link rel="prefetch" href="/myblog/assets/js/24.09693aba.js"><link rel="prefetch" href="/myblog/assets/js/25.d4b3c7d7.js"><link rel="prefetch" href="/myblog/assets/js/26.100da5c7.js"><link rel="prefetch" href="/myblog/assets/js/27.582e641e.js"><link rel="prefetch" href="/myblog/assets/js/28.23ed023d.js"><link rel="prefetch" href="/myblog/assets/js/29.41747558.js"><link rel="prefetch" href="/myblog/assets/js/30.78ec1215.js"><link rel="prefetch" href="/myblog/assets/js/31.0a6a531d.js"><link rel="prefetch" href="/myblog/assets/js/4.4998ca36.js"><link rel="prefetch" href="/myblog/assets/js/5.301a803b.js"><link rel="prefetch" href="/myblog/assets/js/6.b8ee616e.js"><link rel="prefetch" href="/myblog/assets/js/7.8376e3e5.js"><link rel="prefetch" href="/myblog/assets/js/8.f15adf1e.js"><link rel="prefetch" href="/myblog/assets/js/9.fe75b25c.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.73663e0e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>SHANKE BLOG</h3> <p class="description" data-v-59e6cb88>blog of shanke</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>shanke</span>
          
        <span data-v-59e6cb88>2021 - </span>
        2022
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><!----> <span class="site-name">SHANKE BLOG</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/categories/Git/" class="nav-link"><i class="undefined"></i>
  Git
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/MCU/" class="nav-link"><i class="undefined"></i>
  MCU
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/其它/" class="nav-link"><i class="undefined"></i>
  其它
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/springboot/" class="nav-link"><i class="undefined"></i>
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/TorrentManager/" class="nav-link"><i class="undefined"></i>
  TorrentManager
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/unraid/" class="nav-link"><i class="undefined"></i>
  unraid
</a></li></ul></div></div><div class="nav-item"><a href="/myblog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/myblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      文档
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/523757325" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  shanke Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><img src="/myblog/avatar.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    shanke
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>21</h3> <h6 data-v-1fad0c41>文章</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>19</h3> <h6 data-v-1fad0c41>标签</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/categories/Git/" class="nav-link"><i class="undefined"></i>
  Git
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/MCU/" class="nav-link"><i class="undefined"></i>
  MCU
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/其它/" class="nav-link"><i class="undefined"></i>
  其它
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/数据库/" class="nav-link"><i class="undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/springboot/" class="nav-link"><i class="undefined"></i>
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/TorrentManager/" class="nav-link"><i class="undefined"></i>
  TorrentManager
</a></li><li class="dropdown-item"><!----> <a href="/myblog/categories/unraid/" class="nav-link"><i class="undefined"></i>
  unraid
</a></li></ul></div></div><div class="nav-item"><a href="/myblog/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/myblog/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      文档
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/docs/theme-reco/" class="nav-link"><i class="undefined"></i>
  vuepress-reco
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/523757325" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-coding"></i>
  shanke Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>ESP32 FreeRTOS</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>shanke</span>
          
        <span data-v-59e6cb88>2021 - </span>
        2022
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page"><section style="display:;"><div class="page-title"><h1 class="title">ESP32 FreeRTOS</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>shanke</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>2022/7/22</span></i> <!----> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>MCU FreeRTOS ESP32</span></i></div></div> <div class="theme-reco-content content__default"><div class="custom-block tip"><p class="title">说明</p><p>FreeRTOS学习文档，记录相关api</p></div> <h2 id="_1-mutex"><a href="#_1-mutex" class="header-anchor">#</a> 1. MUTEX</h2> <h3 id="_1-1-mutex作用"><a href="#_1-1-mutex作用" class="header-anchor">#</a> 1.1 MUTEX作用</h3> <p>常用于多任务共享变量</p> <h3 id="_1-2-api"><a href="#_1-2-api" class="header-anchor">#</a> 1.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>SemaphoreHandle_t xMutexMPU6050 = NULL; // 创建信号量Handler


xMutexMPU6050 = xSemaphoreCreateMutex(); // 创建MUTEX

if (xSemaphoreTake(xMutexMPU6050, timeOut) == pdPASS) { // 获取钥匙
    // do something
    // ...
    xSemaphoreGive(xMutexMPU6050); // 释放钥匙
} else {
    // Unable to obtain MUTEX
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_2-esp32-双核"><a href="#_2-esp32-双核" class="header-anchor">#</a> 2. ESP32 双核</h2> <h3 id="_2-1-api"><a href="#_2-1-api" class="header-anchor">#</a> 2.1 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 1.创建任务
// a.
xTaskCreate(); // 由系统选择运行核心，优先选择0
// b.
xTaskCreatePinnedToCore(); // 指派任务给指定核心

// 2.获取当前任务运行的核心
xPortGetCoreID();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_3-绝对任务延迟"><a href="#_3-绝对任务延迟" class="header-anchor">#</a> 3. 绝对任务延迟</h2> <h3 id="_3-1-api"><a href="#_3-1-api" class="header-anchor">#</a> 3.1 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 最后一次的唤醒时间是指针类型。
// 本函数会自动更新xLastWakeTime为最后一次唤醒的时间
// 所以无需手动在while循环内对其手动赋值
vTaskDelayUntil(&amp;xLastWakeTime, xFrequency); // xFrequency: delay ticks

// Tick Coun 和 Arduino Millis一样
// uint32_t类型 49天后overflow     
xTaskGetTickCount();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_4-software-timer"><a href="#_4-software-timer" class="header-anchor">#</a> 4. Software Timer</h2> <h3 id="_4-1-api"><a href="#_4-1-api" class="header-anchor">#</a> 4.1 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>TimerHandle_t checkHandle; // timer句柄

// 创建
checkHandle = xTimerCreate(&quot;Sensors Check&quot;,
                             100, // ticks
                             pdTRUE, // 是否循环
                             (void *)1, // timer id
                             checkCallback); // function to call 
// 开始
// 必须要在 portMAX_DELAY 内开启 timer start
// portMAX_DELAY is listed as value for waiting indefinitely
// 实际上0xFFFFFFFF 2^32-1  49天 7周
// 在此期间，此task进入Block状态
xTimerStart(checkHandle, portMAX_DELAY);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="_5-任务内存设置优化"><a href="#_5-任务内存设置优化" class="header-anchor">#</a> 5. 任务内存设置优化</h2> <h3 id="_5-1-api"><a href="#_5-1-api" class="header-anchor">#</a> 5.1 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>ESP.getHeapSize(); //本程序Heap最大尺寸
ESP.getFreeHeap(); //当前Free Heap最大尺寸
uxTaskGetStackHighWaterMark(taskHandle); //Task内存使用最大水位线，内存是水
/*    
What is the Highest Water Mark?
the minimum amount of remaining stack space that was available to the task 
since the task started executing - that is the amount of stack that remained 
unused when the task stack was at its greatest (deepest) value. This is what 
is referred to as the stack 'high water mark'.
*/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_6-任务管理"><a href="#_6-任务管理" class="header-anchor">#</a> 6. 任务管理</h2> <h3 id="_6-1-api"><a href="#_6-1-api" class="header-anchor">#</a> 6.1 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>BaseType_t xTaskCreate(,,,,,); //任务创建
void vTaskDelete( TaskHandle_t xTask ); //任务删除 
void vTaskSuspend( TaskHandle_t xTaskToSuspend ); //任务暂停
void vTaskResume( TaskHandle_t xTaskToResume ); //任务恢复

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="_7-任务优先级"><a href="#_7-任务优先级" class="header-anchor">#</a> 7. 任务优先级</h2> <h3 id="_7-1-说明"><a href="#_7-1-说明" class="header-anchor">#</a> 7.1 说明</h3> <p>说明：高优先级的任务就像是救护车，低优先级的任务就是普通车辆
如同公路上所有普通车辆需要让救护车一样
高优先级任务永远会比低优先级任务优先执行</p> <p>问题：高优先级任务不进入Block或者Suspend状态
低优先级任务就永远不会被执行
这就是著名的任务 《吃撑和饿死》 的问题</p> <h3 id="_7-2-api"><a href="#_7-2-api" class="header-anchor">#</a> 7.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 设置优先级
void vTaskPrioritySet( TaskHandle_t xTask,
                    UBaseType_t uxNewPriority );

// 获取TashHandle任务优先级
UBaseType_t uxTaskPriorityGet( TaskHandle_t xTask );

// 获取当前任务优先级
UBaseType_t uxTaskPriorityGet(NULL);

// 退让资源，任务调度器会重新评估任务，将资源分配给同等级或者更高等级任务
// 注意不会把资源给低等级任务
tastYIELD() yield()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_8-看门狗"><a href="#_8-看门狗" class="header-anchor">#</a> 8. 看门狗</h2> <h3 id="_8-1-说明"><a href="#_8-1-说明" class="header-anchor">#</a> 8.1 说明</h3> <p>说明：看门狗是针对Task任务的
Arduion-ESP32 默认在 Core 0 的 IDLE 任务开启了看门狗 时间为 5000 ticks = 5秒
Core 0 和 Core 1 都运行了 FreeRTOS的IDLE任务，优先级为 0
IDLE任务是用于清理被删除任务的内存
Core 1 loopBack任务就是Arduino的 setup 和 loop 优先级为 1</p> <h3 id="_8-2-api"><a href="#_8-2-api" class="header-anchor">#</a> 8.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>// 1.手动关闭CPU上的TWDT - 慎重操作
disableCore0WDT();
disableCore1WDT();

// 2.
// 给本任务添加看门狗（NULL代表本任务）
// 这个命令需要放在xTaskCreate的前面，否则连运行的机会都没有
esp_task_wdt_add(NULL);
//vTaskDelay(1); //让Task进入Block状态，退让资源
//vTaskSuspend(NULL); //让Task进入Suspend状态，退让资源

// 移除本任务的看门狗（NULL代表本任务）
esp_task_wdt_delete(NULL)

// 3.
// 给自己任务的狗喂时间
esp_task_wdt_reset()

// 通过寄存器给所有任务的狗喂时
void feedTheDogInAllTasks() { 
  // feed dog 0
  TIMERG0.wdt_wprotect = TIMG_WDT_WKEY_VALUE; // write enable
  TIMERG0.wdt_feed = 1;                     // feed dog
  TIMERG0.wdt_wprotect = 0;                 // write protect
  // feed dog 1
  TIMERG1.wdt_wprotect = TIMG_WDT_WKEY_VALUE; // write enable
  TIMERG1.wdt_feed = 1;                     // feed dog
  TIMERG1.wdt_wprotect = 0;                 // write protect
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h2 id="_9-消息队列"><a href="#_9-消息队列" class="header-anchor">#</a> 9. 消息队列</h2> <h3 id="_9-1-说明"><a href="#_9-1-说明" class="header-anchor">#</a> 9.1 说明</h3> <p>可以结合结构体巧妙的通过当个队列传输多个设备多种数据类型
在接收方，我们通过deviceID来判断数据来源和value的意义</p> <h3 id="_9-2-api"><a href="#_9-2-api" class="header-anchor">#</a> 9.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>QueueHandle_t xQueueCreate( UBaseType_t uxQueueLength, // 元素个数
                             UBaseType_t uxItemSize ); // 每个元素占用内存大小 sizeof()

BaseType_t xQueueSend(
                        QueueHandle_t xQueue, // 队列句柄
                        const void * pvItemToQueue, // 元素指针 &amp;message
                        TickType_t xTicksToWait // timeOut ticks
                        );
BaseType_t xQueueReceive(
                            QueueHandle_t xQueue,
                            void *pvBuffer, // 存放的变量指针
                            TickType_t xTicksToWait
                        );
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="_10-信号量-semaphore"><a href="#_10-信号量-semaphore" class="header-anchor">#</a> 10. 信号量 Semaphore</h2> <h3 id="_10-1-二进制信号量-binary-semaphore"><a href="#_10-1-二进制信号量-binary-semaphore" class="header-anchor">#</a> 10.1 二进制信号量 Binary Semaphore</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>SemaphoreHandle_t xHandler; 创建Handler
xHandler = xSemaphoreCreateBinary(); // 创建一个二进制信号量 返回NULL，或者handler
xSemaphoreGive(xHandler); // 生产者+1
xSemaphoreTake(xHanlder, timeout); // 消费者-1 返回pdPASS, 或者pdFAIL

// 二进制信号量可以想成就是一个整数 0 或者 1
// Give就是+1
// Take就是-1

// Take的时候如果这个整数是0的话，就等待一直到timeout

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_10-2-计数信号量-counting-semaphore"><a href="#_10-2-计数信号量-counting-semaphore" class="header-anchor">#</a> 10.2 计数信号量 Counting Semaphore</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>SemaphoreHandle_t xSemaPhone = NULL;

SemaPhone = xSemaphoreCreateCounting(3, 0); // (max, min)

if (xSemaphoreTake(xSemaPhone, portMAX_DELAY) == pdTRUE ) { // -1
    // do something
}

xSemaphoreGive(xSemaPhone); // +1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_11-事件标志组-event-group"><a href="#_11-事件标志组-event-group" class="header-anchor">#</a> 11. 事件标志组 Event Group</h2> <h3 id="_11-1-等待-同步"><a href="#_11-1-等待-同步" class="header-anchor">#</a> 11.1  等待 同步</h3> <h3 id="_11-2-api"><a href="#_11-2-api" class="header-anchor">#</a> 11.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>EventGroupHandle_t xEventPurchase = NULL; //创建event handler
xEventPurchase = xEventGroupCreate(); // 创建 event group

EventBits_t uxBits;  // Event Group 24Bits 的 值

uxBits = xEventGroupSetBits(xEventPurchase, ADDTOCART_0); // 0b0001 将bit 0 设置为1

uxBits = xEventGroupWaitBits (
    xEventPurchase,  //Event Group Handler
    ADDTOCART_0 | PAYMENT_1 | INVENTORY_2, // 0b0001|0b0010|0b0100 等待Event Group中的那个Bit(s)
    pdFALSE,         //执行后，对应的Bits是否重置为 0
    pdTRUE,          //等待的Bits判断关系 True为 AND, False为 OR
    xTimeOut);

uxBits = xEventGroupSync (xEventPurchase,  //Event Group Handler
    ADDTOCART_0,     // 0b0001 先将这个bit(s)设置为 1,然后再等待
    BOUGHT_PAID_SENT,  // 0b0001|0b0010|0b0100 等待这些bits为 1
    xTimeOut);    

uxBits = xEventGroupGetBits(xEventPurchase); //读取    

xEventGroupClearBits(xEventPurchase, ALLBITS); //重置
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_12-流式缓存-stream-buffer"><a href="#_12-流式缓存-stream-buffer" class="header-anchor">#</a> 12. 流式缓存 Stream Buffer</h2> <h3 id="_12-1-说明"><a href="#_12-1-说明" class="header-anchor">#</a> 12.1  说明</h3> <p>FreeRTOS 10以后引入了一个新的数据类型就是 Stream Buffer。它和Queue最大的不同就是，Stream Buffer读写的大小没有限制，而Queue是预设值好固定的值。主要应用比如MP3，视频，在线电台等。</p> <p>程序：  使用Stream Buffer 对流媒体数据，在任务间进行传输
流媒体，读和写的大小都没有任何的限制
读和写的大小可以不一致， 比如写入100 bytes, 可以分成两次每次50 bytes读取出来</p> <p>注意：  适合于一个任务写，另外一个任务读
不适合多任务读写
如果必须要用在多任务的读写，请将内容放入CRITICAL SECTION
可以使用 MUTEX 或者 TASK Notification</p> <h3 id="_12-2-api"><a href="#_12-2-api" class="header-anchor">#</a> 12.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>//不要忘记include stream_buffer.h
#include &lt;freertos/stream_buffer.h&gt;

StreamBufferHandle_t xStreamMusic = NULL; //创建一个 Stream Buffer 的 handler

// 创建Stream Buffer
// Stream Buffer的最大尺寸，如果超出可能内存空间，那么创建Stream Buffer就会失败
const size_t xStreamBufferSizeBytes = 540;
// Trigger Level - Stream Buffer内数据超过这个数值，才会被读取
const size_t xTriggerLevel = 8;
xStreamMusic = xStreamBufferCreate(xStreamBufferSizeBytes, xTriggerLevel);

if ( xStreamMusic == NULL )
{ //内存不过，无法创建Stream Buffer
    Serial.println(&quot;UNABLE TO CREATE STREAM BUFFER&quot;);
}

// 发送 buffer满了后该方法会阻塞等待发送
size_t xBytesSent; //The number of bytes written to the stream buffer.
xBytesSent = xStreamBufferSend( 
    xStreamMusic,
    (void *)&amp;music, // 发送的数据
    sizeof(music), // 发送大小
    portMAX_DELAY); // timeout

if ( xBytesSent != sizeof( music ) ) {
    Serial.println(&quot;警告: xStreamBufferSend 写入数据出错&quot;);  //Optional
}

// 接收 没有数据或者小于xTriggerLevel会阻塞
size_t xReceivedBytes; //The number of bytes read from the stream buffer.
size_t xReadBytes = 8*10-1;
xReceivedBytes = xStreamBufferReceive( 
    xStreamMusic,
    ( void * ) &amp;music, // 存放的变量指针
    xReadBytes, // 读取大小
    portMAX_DELAY );
if ( xReceivedBytes &gt; 0 )
{
    // do something
}

// 查看使用情况 可创建task实现监控
size_t xAvailable, xUsed;
bool isFull;
//Queries a stream buffer to see if it is full.
if (xStreamBufferIsFull(xStreamMusic) == pdTRUE) Serial.println(&quot;xStreamMusic 已满&quot;);

//Queries a stream buffer to see how much data it contains
xUsed =  xStreamBufferBytesAvailable(xStreamMusic);

//Queries a stream buffer to see how much free space it contains
xAvailable = xStreamBufferSpacesAvailable(xStreamMusic);

char msg[40];
sprintf(msg, &quot;xStreamBuffer已使用 %d 字节&quot;, xUsed);
Serial.println(msg);
sprintf(msg, &quot;xStreamBuffer可用空间为 %d 字节&quot;, xAvailable);
Serial.println(msg);

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><h2 id="_13-消息缓存-message-buffer"><a href="#_13-消息缓存-message-buffer" class="header-anchor">#</a> 13. 消息缓存 Message Buffer</h2> <h3 id="_13-1-说明"><a href="#_13-1-说明" class="header-anchor">#</a> 13.1  说明</h3> <p>Message Buffer是基于Stream Buffer的。只是在每一次发送数据的时候多了四个字节的空间用于存放消息的大小。更具这个消息大小，读取放就可以一次读取出全部消息的内容。</p> <p>很适合 串口 接收和发送数据，每次的大小不定，但是接受和发送的数据量需要相同</p> <h3 id="_13-2-api"><a href="#_13-2-api" class="header-anchor">#</a> 13.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>//不要忘记include message_buffer.h
#include &lt;freertos/message_buffer.h&gt;

MessageBufferHandle_t xMessageBuffer = NULL;

// 创建
const size_t xMessageBufferSizeBytes = 100;
xMessageBuffer = xMessageBufferCreate( xMessageBufferSizeBytes );

if ( xMessageBuffer == NULL )
{
    Serial.println(&quot;Unable to Create Message Buffer&quot;);
}

// 发送
xMessageBufferSend( 
    xMessageBuffer,
    ( void * ) &amp;gpsInfo,
    sizeof( gpsInfo ),
    portMAX_DELAY );

// 接收
xReceivedBytes = xMessageBufferReceive( 
    xMessageBuffer,
    ( void * ) &amp;gpsInfo,
    xMessageSizeMax, // This sets the maximum length of the message that can be received.
    portMAX_DELAY );

// 查看使用情况
size_t xAvailable, xUsed;
bool isFull;
//Queries a stream buffer to see if it is full.
if (xMessageBufferIsFull(xMessageBuffer) == pdTRUE) Serial.println(&quot;xMessageBuffer 已满&quot;);

//Queries a stream buffer to see how much free space it contains
xAvailable = xMessageBufferSpacesAvailable(xMessageBuffer);

char msg[40];
sprintf(msg, &quot;xMessageBuffer可用空间为 %d 字节&quot;, xAvailable);
Serial.println(msg);


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><h2 id="_11-直接任务通知-direct-task-notification"><a href="#_11-直接任务通知-direct-task-notification" class="header-anchor">#</a> 11. 直接任务通知 Direct Task Notification</h2> <h3 id="_11-1-说明"><a href="#_11-1-说明" class="header-anchor">#</a> 11.1  说明</h3> <p>Direct Task Notification是FreeRTOS 10版本以后的最重要的一个功能。他可以实现大部分二进制信号量，计数信号量，事件组，邮箱等等的功能。而且速度快45%，已经占用更少的内存。</p> <p><em>要点</em>：</p> <ul><li>一个任务可以有多个notification</li> <li>每个notification包含4个字节的value 和 1个字节的stats</li> <li>stats用来记录当前的notification有没有被处理 pending or not pending</li> <li>我们不能对stats进行直接的读写操作，是系统自动的</li> <li>我们只能对notification value 进行操作</li></ul> <h3 id="_11-2-api-对notification的读-写-和-等待。"><a href="#_11-2-api-对notification的读-写-和-等待。" class="header-anchor">#</a> 11.2 API 对notification的读，写 和 等待。</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
static TaskHandle_t xTaskWait = NULL;
static TaskHandle_t xTaskGive = NULL;

#define LOWTHREEBITS ( 1UL &lt;&lt; 0UL )|( 1UL &lt;&lt; 1UL )|( 1UL &lt;&lt; 2UL )

void taskWait(void *pvParam) {
  uint32_t ulNotificationValue; //用来存放本任务的4个字节的notification value
  BaseType_t xResult;

  while (1) {
    //vTaskDelay(1000);
    xResult = xTaskNotifyWait(
        0x00, //在运行前这个命令之前，先清除这几位
        0x00, //运行后，重置所有的bits 0x00 or ULONG_MAX or 0xFFFFFFFF
        &amp;ulNotificationValue, //重置前的notification value
        portMAX_DELAY ); //一直等待
                      
    if (xResult == pdTRUE) {
      Serial.println(ulNotificationValue); //将自己的notification value以二进制方式打出来
    } else {
      Serial.println(&quot;Timeout&quot;);
    }
  }
}

void taskGive(void *pvParam) {
  pinMode(23, INPUT_PULLUP);
  BaseType_t xResult;
  while (1) {
    if (digitalRead(23) == LOW) {
      xResult=xTaskNotify( xTaskWait, 0, eIncrement );  //对方的notification value +1
      //xResult=xTaskNotify( xTaskWait, 0, eNoAction ); //不设置对方的notification value
      //xResult=xTaskNotify( xTaskWait, ( 1UL &lt;&lt; 4UL ), eSetBits ); //第3个bits 设置为 1 和 原有的值是OR运算
      //xResult=xTaskNotify( xTaskWait, 0, eIncrement );  //对方的notification value +1
      //xResult=xTaskNotify( xTaskWait, LOWTHREEBITS, eSetValueWithOverwrite ); //覆盖原有的值
      //xResult=xTaskNotify( xTaskWait, 0b11111111, eSetValueWithOverwrite ); //覆盖原有的值
      //xResult=xTaskNotify( xTaskWait, 0xFF, eSetValueWithOverwrite ); //覆盖原有的值
      //xResult=xTaskNotify( xTaskWait, LOWTHREEBITS, eSetValueWithoutOverwrite); //如果没有待处理的就覆盖，如果有待处理的就pending
      Serial.println(xResult == pdPASS ? &quot;成功\n&quot;:&quot;失败\n&quot;);
      
      vTaskDelay(120); //消除按钮抖动
    }
  }
}
void setup() {
  Serial.begin(115200);

  xTaskCreate(taskGive, &quot;&quot;, 1024 * 4, NULL, 1, &amp;xTaskGive);
  xTaskCreate(taskWait, &quot;&quot;, 1024 * 4, NULL, 1, &amp;xTaskWait);
}

void loop() { }

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br></div></div><h3 id="_11-3-api-实现二进制信号量"><a href="#_11-3-api-实现二进制信号量" class="header-anchor">#</a> 11.3 API 实现二进制信号量</h3> <p><code>xTaskNotifyGive</code> 相当于精简化的 xTaskNotify() + eIncrement</p> <p><code>ulTaskNotifyTake</code> waitting for notification, then reset to 0</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>TaskHandle_t xflashLED = NULL;

void flashLED(void *pvParam) {
  uint32_t ulNotificationValue;
  pinMode(23, OUTPUT);
  while (1) {
    //返回运行此命令之前的Notification Value
    //命令含义: waitting for notification, then reset
    ulNotificationValue = ulTaskNotifyTake(pdTRUE, //pdTRUE 运行完后，清零
                                           portMAX_DELAY);

    if ( ulNotificationValue &gt; 0 )
    {
      digitalWrite(23, !digitalRead(23));
      vTaskDelay(1000);
    }
  }
}

void readBtn(void *pvParam) {

  pinMode(22, INPUT_PULLUP);

  while (1) {
    if (digitalRead(22) == LOW) {
      //命令含义，相当于精简化的 xTaskNotify() + eIncrement
      xTaskNotifyGive(xflashLED);
      vTaskDelay(120); //button debounce
    }
  }
}


void setup() {
  // put your setup code here, to run once:
  Serial.begin(115200);

  xTaskCreate(flashLED, &quot;Flash LED&quot;, 1024 * 4, NULL, 1, &amp;xflashLED);
  xTaskCreate(readBtn, &quot;Read Button&quot;, 1024 * 4, NULL, 1, NULL);

}

void loop() {
}

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h2 id="_11-xxx"><a href="#_11-xxx" class="header-anchor">#</a> 11. xxx</h2> <h3 id="_11-1-说明-2"><a href="#_11-1-说明-2" class="header-anchor">#</a> 11.1  说明</h3> <h3 id="_11-2-api-2"><a href="#_11-2-api-2" class="header-anchor">#</a> 11.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_11-xxx-2"><a href="#_11-xxx-2" class="header-anchor">#</a> 11. xxx</h2> <h3 id="_11-1-说明-3"><a href="#_11-1-说明-3" class="header-anchor">#</a> 11.1  说明</h3> <h3 id="_11-2-api-3"><a href="#_11-2-api-3" class="header-anchor">#</a> 11.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_11-xxx-3"><a href="#_11-xxx-3" class="header-anchor">#</a> 11. xxx</h2> <h3 id="_11-1-说明-4"><a href="#_11-1-说明-4" class="header-anchor">#</a> 11.1  说明</h3> <h3 id="_11-2-api-4"><a href="#_11-2-api-4" class="header-anchor">#</a> 11.2 API</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2022/8/5 04:12:37</span></div></footer> <!----> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:12rem;" data-v-ac050c62><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_1-mutex" class="sidebar-link reco-side-_1-mutex" data-v-ac050c62>1. MUTEX</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_1-1-mutex作用" class="sidebar-link reco-side-_1-1-mutex作用" data-v-ac050c62>1.1 MUTEX作用</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_1-2-api" class="sidebar-link reco-side-_1-2-api" data-v-ac050c62>1.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_2-esp32-双核" class="sidebar-link reco-side-_2-esp32-双核" data-v-ac050c62>2. ESP32 双核</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_2-1-api" class="sidebar-link reco-side-_2-1-api" data-v-ac050c62>2.1 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_3-绝对任务延迟" class="sidebar-link reco-side-_3-绝对任务延迟" data-v-ac050c62>3. 绝对任务延迟</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_3-1-api" class="sidebar-link reco-side-_3-1-api" data-v-ac050c62>3.1 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_4-software-timer" class="sidebar-link reco-side-_4-software-timer" data-v-ac050c62>4. Software Timer</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_4-1-api" class="sidebar-link reco-side-_4-1-api" data-v-ac050c62>4.1 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_5-任务内存设置优化" class="sidebar-link reco-side-_5-任务内存设置优化" data-v-ac050c62>5. 任务内存设置优化</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_5-1-api" class="sidebar-link reco-side-_5-1-api" data-v-ac050c62>5.1 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_6-任务管理" class="sidebar-link reco-side-_6-任务管理" data-v-ac050c62>6. 任务管理</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_6-1-api" class="sidebar-link reco-side-_6-1-api" data-v-ac050c62>6.1 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_7-任务优先级" class="sidebar-link reco-side-_7-任务优先级" data-v-ac050c62>7. 任务优先级</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_7-1-说明" class="sidebar-link reco-side-_7-1-说明" data-v-ac050c62>7.1 说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_7-2-api" class="sidebar-link reco-side-_7-2-api" data-v-ac050c62>7.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_8-看门狗" class="sidebar-link reco-side-_8-看门狗" data-v-ac050c62>8. 看门狗</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_8-1-说明" class="sidebar-link reco-side-_8-1-说明" data-v-ac050c62>8.1 说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_8-2-api" class="sidebar-link reco-side-_8-2-api" data-v-ac050c62>8.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_9-消息队列" class="sidebar-link reco-side-_9-消息队列" data-v-ac050c62>9. 消息队列</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_9-1-说明" class="sidebar-link reco-side-_9-1-说明" data-v-ac050c62>9.1 说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_9-2-api" class="sidebar-link reco-side-_9-2-api" data-v-ac050c62>9.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_10-信号量-semaphore" class="sidebar-link reco-side-_10-信号量-semaphore" data-v-ac050c62>10. 信号量 Semaphore</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_10-1-二进制信号量-binary-semaphore" class="sidebar-link reco-side-_10-1-二进制信号量-binary-semaphore" data-v-ac050c62>10.1 二进制信号量 Binary Semaphore</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_10-2-计数信号量-counting-semaphore" class="sidebar-link reco-side-_10-2-计数信号量-counting-semaphore" data-v-ac050c62>10.2 计数信号量 Counting Semaphore</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-事件标志组-event-group" class="sidebar-link reco-side-_11-事件标志组-event-group" data-v-ac050c62>11. 事件标志组 Event Group</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-1-等待-同步" class="sidebar-link reco-side-_11-1-等待-同步" data-v-ac050c62>11.1  等待 同步</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-2-api" class="sidebar-link reco-side-_11-2-api" data-v-ac050c62>11.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_12-流式缓存-stream-buffer" class="sidebar-link reco-side-_12-流式缓存-stream-buffer" data-v-ac050c62>12. 流式缓存 Stream Buffer</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_12-1-说明" class="sidebar-link reco-side-_12-1-说明" data-v-ac050c62>12.1  说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_12-2-api" class="sidebar-link reco-side-_12-2-api" data-v-ac050c62>12.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_13-消息缓存-message-buffer" class="sidebar-link reco-side-_13-消息缓存-message-buffer" data-v-ac050c62>13. 消息缓存 Message Buffer</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_13-1-说明" class="sidebar-link reco-side-_13-1-说明" data-v-ac050c62>13.1  说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_13-2-api" class="sidebar-link reco-side-_13-2-api" data-v-ac050c62>13.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-直接任务通知-direct-task-notification" class="sidebar-link reco-side-_11-直接任务通知-direct-task-notification" data-v-ac050c62>11. 直接任务通知 Direct Task Notification</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-1-说明" class="sidebar-link reco-side-_11-1-说明" data-v-ac050c62>11.1  说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-2-api-对notification的读-写-和-等待。" class="sidebar-link reco-side-_11-2-api-对notification的读-写-和-等待。" data-v-ac050c62>11.2 API 对notification的读，写 和 等待。</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-3-api-实现二进制信号量" class="sidebar-link reco-side-_11-3-api-实现二进制信号量" data-v-ac050c62>11.3 API 实现二进制信号量</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-xxx" class="sidebar-link reco-side-_11-xxx" data-v-ac050c62>11. xxx</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-1-说明-2" class="sidebar-link reco-side-_11-1-说明-2" data-v-ac050c62>11.1  说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-2-api-2" class="sidebar-link reco-side-_11-2-api-2" data-v-ac050c62>11.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-xxx-2" class="sidebar-link reco-side-_11-xxx-2" data-v-ac050c62>11. xxx</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-1-说明-3" class="sidebar-link reco-side-_11-1-说明-3" data-v-ac050c62>11.1  说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-2-api-3" class="sidebar-link reco-side-_11-2-api-3" data-v-ac050c62>11.2 API</a></li><li class="level-2" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-xxx-3" class="sidebar-link reco-side-_11-xxx-3" data-v-ac050c62>11. xxx</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-1-说明-4" class="sidebar-link reco-side-_11-1-说明-4" data-v-ac050c62>11.1  说明</a></li><li class="level-3" data-v-ac050c62><a href="/myblog/blogs/mcu/rtosdoc.html#_11-2-api-4" class="sidebar-link reco-side-_11-2-api-4" data-v-ac050c62>11.2 API</a></li></ul></main></div> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div></div></div>
    <script src="/myblog/assets/js/app.d79486e6.js" defer></script><script src="/myblog/assets/js/3.525b3326.js" defer></script><script src="/myblog/assets/js/1.3355827a.js" defer></script><script src="/myblog/assets/js/13.e2877f91.js" defer></script>
  </body>
</html>
